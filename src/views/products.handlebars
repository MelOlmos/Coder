<div>
  <h1>Hi, {{ first_name }} !</h1>
  TU ROL ES: {{ role }} <br><br>

  <form action="/api/session/logout" method="POST"> <button type="submit">LOGOUT</button>
</form>

<button onclick="redirectToPurchase()">Finalizar compra</button>

<script>
//lo que hace redirectToPurchase
  function redirectToPurchase() {
    window.location.href = '/api/carts/65b3fd56c512050429ca55ec/purchase';
  }
</script>


  <h2>Products result</h2>
{{#each products}}
    <ul>
      <li><strong>Title:</strong> {{this.title}}</li>
      <li><strong>Descripcion:</strong> {{this.description}}</li>
      <li><strong>Category:</strong> {{this.category}}</li>
      <li><strong>Price:</strong> {{this.price}}</li>
      <li><strong>Stock:</strong> {{this.stock}}</li>
    </ul>

    <button onclick="addToCart('{{this._id}}')">Agregar al carrito</button>
    
    <div id='{{this._id}}'></div>
  {{/each}}

<script>

  // Esto hace la acción onclick
  function addToCart(productId) {
     console.log('Product ID:', productId);
    //
    fetch(`/api/carts/65b3fd56c512050429ca55ec/products`, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({ productId: productId, quantity: 1 }),
    })
    .then(response => response.json())
    .then(data => {
      document.getElementById(productId).innerHTML = "Producto agregado correctamente ✔";
      console.log(data);
    })
    .catch(error => console.error('Error al agregar al carrito:', error));
    //
    {{!-- function redirectToPurchase() {
      window.location.href = "/api/carts/65b3fd56c512050429ca55ec/purchase";
    } --}}
  }
</script>

<div>
{{#if hasPrevPage}}
    <a href="/products?page={{prevPage}}">Before</a>
    {{/if}}
    <label> {{page}} </label>
    {{#if hasNextPage}}
    <a href="/products?page={{nextPage}}">Next</a>
    {{/if}}
</div>
</div>